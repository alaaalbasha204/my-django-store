{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">

{% if messages %}
  <div class="notification-wrapper">
    {% for message in messages %}
      <div class="notification {{ message.tags }}">{{ message }}</div>
    {% endfor %}
  </div>
{% endif %}

{% if request.user.is_staff %}
  <nav class="admin-nav">
    <a href="/admin/"> Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© âš™ï¸</a>
  </nav>
{% endif %}

<div class="container">

 <header class="topbar">
  <a href="{% url 'cart' %}" class="cart-btn" aria-label="Ø¹Ø±Ø¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚">
    <span class="cart-emoji">ğŸ›ï¸</span>
    <span class="cart-text">Ø§Ù„Ø³Ù„Ø©</span>
    <!-- <span class="cart-count">{{ request.session.cart|length }}</span> -->
  </a>

  <form class="search-form" method="get" action="{% url 'index' %}">
    <input type="search" name="q" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." value="{{ search_query }}" aria-label="Ø¨Ø­Ø«">
    <button type="submit">Ø¨Ø­Ø«</button>
  </form>

  <a href="#" class="store-name">Ù…ØªØ¬Ø±Ù†Ø§ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ğŸ›’</a>
</header>



  <section class="main-content">
    <nav class="category-menu">
      <h3>Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</h3>
      <form method="post" action="">
        {% csrf_token %}
        <label><input type="submit" name="category" value="clothes"> Ù…Ù„Ø§Ø¨Ø³ ğŸ‘—</label>
        <label><input type="submit" name="category" value="food"> Ø·Ø¹Ø§Ù… ğŸ•</label>
        <label><input type="submit" name="category" value="kitchin"> Ù…Ø·Ø¨Ø® ğŸ´</label>
         <label><input type="submit" name="category" value="elctronic"> Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª ğŸ’»</label>
      </form>
    </nav>

    <div class="products-grid">
      {% if products %}
        {% for product in products %}
          <article class="product-item" tabindex="0">
            <img src="{{ product.image.url }}" alt="{{ product.name }}" loading="lazy">
            <h4>{{ product.name }}</h4>
            <p class="price">Ø§Ù„Ø³Ø¹Ø±: {{ product.price }} $</p>

            <form method="post" action="" class="btn-group">
              {% csrf_token %}
              <input type="hidden" name="product" value="{{ product.id }}">
              <button class="btn add-btn" type="submit">Ø¥Ø¶Ø§ÙØ© ğŸ›’</button>
            </form>

            {% if product.id in cart_product_ids %}
              <form method="post" action="" class="btn-group">
                {% csrf_token %}
                <input type="hidden" name="product" value="{{ product.id }}">
                <input type="hidden" name="remove" value="1">
                <button class="btn remove-btn" type="submit">Ø¥Ø²Ø§Ù„Ø© âŒ</button>
              </form>
            {% endif %}

            <a href="{% url 'detail' product.id %}" class="detail-link">ØªÙØ§ØµÙŠÙ„ ğŸ”</a>
          </article>
        {% endfor %}
      {% else %}
        <p class="no-products">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª.</p>
      {% endif %}
    </div>
  </section>

  <footer class="cart-summary">
    <h3>Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø³Ù„Ø©</h3>
    <ul>
      {% for product_id, quantity in request.session.cart.items %}
        <li>Ø§Ù„Ù…Ù†ØªØ¬ Ø±Ù‚Ù… {{ product_id }} - Ø§Ù„ÙƒÙ…ÙŠØ©: {{ quantity }}</li>
      {% empty %}
        <li>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©.</li>
      {% endfor %}
    </ul>
  </footer>

</div>
{% endblock %}
